RDBUFF     MACRO     &INDEV,&BUFADR,&RECLTH,&EOR
&EORCT     SET       %NITEMS(&EOR)
           CLEAR     X          CLEAR LOOP COUNTER
           CLEAR     A
          +LDT      #4096       SET MAX LENGTH = 4096          
$LOOP      TD       =X'&INDEV'  TEST INPUT DEVICE
 	   JEQ       $LOOP	LOOP UNTIL READY
	   RD       =X'&INDEV'  READ CHARACTER INTO REG A
&CTR	   SET 	     1
	   WHILE     (&CTR LE &EORCT)
	   COMP     =X'0000&EOR[&CTR]'
	   JEQ	     $EXIT
&CTR	   SET	     &CTR+1
	   ENDW
	   STCH	     &BUFADR,X	STORE CHARACTER IN BUFFER
	   TIXR	     T		LOOP UNLESS MAXIMUM LENGTH
	   JLT	     $LOOP	  HAS BEEN REACHED
$EXIT	   STX	     &RECLTH	SAVE RECORD LENGTH
	   MEND
FIRST    RDBUFF    F3,BUFFER,LENGTH,(00,03,04)
		END FIRST