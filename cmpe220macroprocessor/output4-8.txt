.FIRST    RDBUFF    F3,BUF,RECL,04,2048
           ENDIF
           CLEAR     X          CLEAR LOOP COUNTER
           CLEAR     A
           LDCH     =X'04'    SET EOR CHARACTER
           RMO       A,S
           ENDIF
$AALOOP      TD       =X'F3'  TEST INPUT DEVICE
 	   JEQ       $AALOOP	LOOP UNTIL READY
	   RD       =X'F3'  READ CHARACTER INTO REG A
	   COMPR     A,S	TEST FOR END OF RECORD
	   JEQ       $AAEXIT	EXIT LOOP IF EOR
	   ENDIF
	   STCH	     $AABUFADR,X	STORE CHARACTER IN BUFFER
	   TIXR	     T		LOOP UNLESS MAXIMUM LENGTH
	   JLT	     $AALOOP	  HAS BEEN REACHED
$AAEXIT	   STX	     RECL	SAVE RECORD LENGTH
.	     RDBUFF    0E,BUFFER,LENGTH,,80
           ENDIF
           CLEAR     X          CLEAR LOOP COUNTER
           CLEAR     A
           LDCH     =X'80'    SET EOR CHARACTER
           RMO       A,S
           ENDIF
$ABLOOP      TD       =X'0E'  TEST INPUT DEVICE
 	   JEQ       $ABLOOP	LOOP UNTIL READY
	   RD       =X'0E'  READ CHARACTER INTO REG A
	   COMPR     A,S	TEST FOR END OF RECORD
	   JEQ       $ABEXIT	EXIT LOOP IF EOR
	   ENDIF
	   STCH	     $ABBUFADR,X	STORE CHARACTER IN BUFFER
	   TIXR	     T		LOOP UNLESS MAXIMUM LENGTH
	   JLT	     $ABLOOP	  HAS BEEN REACHED
$ABEXIT	   STX	     LENGTH	SAVE RECORD LENGTH
.      	 RDBUFF    F1,BUFF,RLENG,04
           ENDIF
           CLEAR     X          CLEAR LOOP COUNTER
           CLEAR     A
           LDCH     =X'04'    SET EOR CHARACTER
           RMO       A,S
           ENDIF
$ACLOOP      TD       =X'F1'  TEST INPUT DEVICE
 	   JEQ       $ACLOOP	LOOP UNTIL READY
	   RD       =X'F1'  READ CHARACTER INTO REG A
	   COMPR     A,S	TEST FOR END OF RECORD
	   JEQ       $ACEXIT	EXIT LOOP IF EOR
	   ENDIF
	   STCH	     $ACBUFADR,X	STORE CHARACTER IN BUFFER
	   TIXR	     T		LOOP UNLESS MAXIMUM LENGTH
	   JLT	     $ACLOOP	  HAS BEEN REACHED
$ACEXIT	   STX	     RLENG	SAVE RECORD LENGTH
		END FIRST